#include "bignum.h"
#include <criterion/criterion.h>

TestSuite(div);

Test(div, div_ub) {
    bn_t in, out;
    if(!bn_inits(2, &in, &out)) cr_assert_fail("Could not init bignum.");

    bn_conv_str2bn("1234567891011121314151617181920", in);

    uint8_t denominators[] = {2,3,4,5,8,10,11,16,17,32,42,64,69,100,111,123,128,145,150,169,199,215,222,255};
    const char *results[] = { "617283945505560657075808590960","411522630337040438050539060640","308641972752780328537904295480","246913578202224262830323436384","154320986376390164268952147740","123456789101112131415161718192","112233444637374664922874289265","77160493188195082134476073870","72621640647713018479506893054","38580246594097541067238036935","29394473595502888432181361474","19290123297048770533619018467","17892288275523497306545176549","12345678910111213141516171819","11122233252352444271636190828","10037137325293669220744855137","9645061648524385266809509233","8514261317318078028631842633","8230452606740808761010781212","7305135449769948604447438946","6203858748799604593726719507","5742176237261029368147056660","5561116626176222135818095414","4841442709847534565300459536"};

    for(int i = 0; i < sizeof(denominators); i++) {
        bn_div_ub(in, denominators[i], out);
        char *res = bn_conv_bn2str(out);
        cr_expect_str_eq(res, results[i], "Failure dividing by %u. Expected: %s. Actual: %s", denominators[i], results[i], res);
        free(res);
    }
}
