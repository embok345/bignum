#include "bignum.h"

const uint8_t DH_14_BLOCKS[256] = {255,255,255,255,255,255,255,255,104,170,172,138,90,142,114,21,16,5,250,152,24,38,210,21,229,106,149,234,124,73,149,57,24,23,88,149,246,203,43,222,201,82,76,111,240,93,197,181,143,162,7,236,162,131,39,155,3,134,14,24,44,119,158,227,59,206,54,46,70,94,144,50,124,33,24,202,8,108,116,241,4,152,188,74,78,53,12,103,109,150,150,112,7,41,213,158,187,82,133,32,86,243,98,28,150,173,163,220,35,93,101,131,95,207,36,253,168,63,22,105,154,211,85,28,54,72,218,152,5,191,99,161,184,124,0,194,61,91,228,236,81,102,40,73,230,31,75,124,17,36,159,174,165,159,137,90,251,107,56,238,237,183,6,244,182,92,255,11,107,237,55,166,233,66,76,244,198,126,94,98,118,181,133,228,69,194,81,109,109,53,225,79,55,20,95,242,109,10,43,48,27,67,58,205,179,25,149,239,221,4,52,142,121,8,74,81,34,155,19,59,166,190,11,2,116,204,103,138,8,78,2,41,209,28,220,128,139,98,198,196,52,194,104,33,162,218,15,201,255,255,255,255,255,255,255,255};

int main() {
  srand(time(NULL));

  register_printf_specifier('B', bn_printf, bn_printf_info);

  bignum *a, *b, *c, *d, *e, *q;
  bn_inits(6, &a, &b, &c, &d, &e, &q);

  //bn_rand_blocks(a, 256);
  bn_set(a, 256, DH_14_BLOCKS, 1);

  bn_float *mod, *quot;
  bnf_inits(2, &mod, &quot);
  bnf_invert(a, mod);

  for(int i = 0; i<1000; i++) {
    bn_rand(b, a);
    bn_mul(b, b, b);

    bnf_mul_bn(mod, b, quot);
    //bnf_integerPart(quot, q);

    //bn_div_rem(b, a, q);
  }


  /*bignum *p, *g, *x, *e;
  bn_inits(4, &p, &g, &x, &e);

  bn_set(p, 256, DH_14_BLOCKS, 1);
  bn_conv_int2bn(2, g);
  bn_rand(x, p);
  bn_powmod(g, x, p, e);

  printf("%B ^ %B mod %B = %B\n", g, x, p, e);*/
}
